<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Tool SEO AI Tá»± Äá»™ng</title>
</head>
<body>

<!-- âœ… TÃ­ch há»£p AI vÃ o Tool SEO: Gá»“m caption áº£nh AI, má»Ÿ bÃ i AI, hashtag AI -->
<!-- ğŸŒŸ ChÃ¨n Ä‘oáº¡n nÃ y vÃ o trong pháº§n <body> -->

<div style="margin-top: 20px;">
  <button class="btn btn-success" onclick="generateIntroFromAI()">âœï¸ AI Viáº¿t Má»Ÿ BÃ i</button>
  <button class="btn btn-warning" onclick="suggestHashtagsFromAI()">ğŸ¯ AI Gá»£i Ã Hashtag</button>
</div>

<script>
const OPENAI_PROXY_URL = "http://localhost:3001/openai";

async function callOpenAI(messages) {
  const res = await fetch(OPENAI_PROXY_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ messages })
  });
  const data = await res.json();
  return data.choices?.[0]?.message?.content.trim() || "KhÃ´ng cÃ³ pháº£n há»“i tá»« AI.";
}

// ğŸ–¼ï¸ Caption áº£nh AI
async function generateImageCaptionAI(imageUrl, keyword) {
  return await callOpenAI([
    { role: "system", content: "Báº¡n lÃ  chuyÃªn gia viáº¿t caption áº£nh cho bÃ i viáº¿t SEO" },
    { role: "user", content: `Viáº¿t caption áº£nh ngáº¯n (dÆ°á»›i 20 tá»«), háº¥p dáº«n cho áº£nh sau: ${imageUrl}, theo chá»§ Ä‘á» "${keyword}".` }
  ]);
}

// âœï¸ Äoáº¡n má»Ÿ bÃ i AI
async function generateSEOBodyAI(topic, keyword, description) {
  return await callOpenAI([
    { role: "system", content: "Báº¡n lÃ  chuyÃªn gia viáº¿t bÃ i SEO tiáº¿ng Viá»‡t." },
    { role: "user", content: `Viáº¿t Ä‘oáº¡n má»Ÿ Ä‘áº§u háº¥p dáº«n cho bÃ i viáº¿t vá» "${topic}" (tá»« khÃ³a: ${keyword}). ${description ? "Gá»£i Ã½ ná»™i dung: " + description : ""}` }
  ]);
}

// ğŸ”– Hashtag AI
async function generateHashtagsAI(keyword) {
  return await callOpenAI([
    { role: "system", content: "Báº¡n lÃ  chuyÃªn gia máº¡ng xÃ£ há»™i." },
    { role: "user", content: `Táº¡o 10 hashtag khÃ´ng dáº¥u, dáº¡ng #tag, cho tá»« khÃ³a "${keyword}".` }
  ]);
}

// NÃºt táº¡o má»Ÿ bÃ i AI
async function generateIntroFromAI() {
  const topic = document.getElementById('mainTopic').value;
  const keyword = document.getElementById('mainKeyword').value;
  const desc = document.getElementById('description').value;

  showStatus('info', 'âœï¸ Äang táº¡o má»Ÿ bÃ i báº±ng AI...');
  const intro = await generateSEOBodyAI(topic, keyword, desc);
  document.getElementById('description').value = intro;
  showStatus('success', 'âœ… ÄÃ£ táº¡o Ä‘oáº¡n má»Ÿ bÃ i tá»« AI!');
}

// NÃºt gá»£i Ã½ hashtag AI
async function suggestHashtagsFromAI() {
  const keyword = document.getElementById('mainKeyword').value;
  showStatus('info', 'ğŸ” Äang gá»£i Ã½ hashtag tá»« AI...');
  const hashtags = await generateHashtagsAI(keyword);
  document.getElementById('tags').value = hashtags.replace(/#/g, '').replace(/\s+/g, ', ');
  showStatus('success', 'âœ… Hashtag Ä‘Ã£ Ä‘Æ°á»£c cáº­p nháº­t!');
}

// âœ… Gá»i caption AI cho tá»«ng áº£nh khi upload xong
async function displayUploadedImage(url) {
  const container = document.querySelector('.uploaded-images');
  const keyword = document.getElementById('mainKeyword').value || 'gÃ¡i xinh';

  const captionText = await generateImageCaptionAI(url, keyword);

  const imageItem = document.createElement('div');
  imageItem.className = 'image-item';
  imageItem.innerHTML = `
    <img src="${url}" alt="áº¢nh" class="image-preview">
    <input type="text" class="image-url" value="${url}" readonly onclick="this.select()">
    <p style="margin-top: 10px; font-style: italic; color: #666;">${captionText}</p>
    <button class="btn" style="background: #dc3545; margin-top: 10px;" onclick="removeImage('${url}')">
      ğŸ—‘ï¸ XÃ³a
    </button>
  `;
  container.appendChild(imageItem);
}
</script>

</body>
</html>
