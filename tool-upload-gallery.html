<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Upload áº£nh vÃ  Ä‘Äƒng Blogger</title>
  <style>
    /* Giá»¯ nguyÃªn CSS tá»« mÃ£ gá»‘c */
    /* ... (copy toÃ n bá»™ pháº§n style trong mÃ£ cá»§a báº¡n á»Ÿ Ä‘Ã¢y) ... */
  </style>
  <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>
  <div class="dropzone"><div class="infoimg"></div></div>
  <div class="status"></div>
  <button id="copyAllLinksBtn">ğŸ“‹ Copy táº¥t cáº£ link áº£nh</button>
  <br><br>
  <input type="text" id="keywords" placeholder="Nháº­p tá»« khÃ³a SEO (vd: áº£nh gÃ¡i xinh Viá»‡t Nam, bikini...)" style="width: 80%;">
  <button id="generatePost">ğŸ“ Táº¡o bÃ i viáº¿t Blogger</button>

  <script>
    const allLinks = [];
    const copyBtn = document.getElementById('copyAllLinksBtn');

    function updateCopyButton() {
      if (allLinks.length > 0) copyBtn.style.display = 'block';
    }

    function generateSeoContent(keywords) {
      const title = `Tá»•ng há»£p ${keywords} má»›i nháº¥t cá»±c cháº¥t`;
      const description = `Bá»™ sÆ°u táº­p ${keywords.toLowerCase()} cháº¥t lÆ°á»£ng cao vá»›i cÃ¡c chá»§ Ä‘á» hot nhÆ° gÃ¡i xinh Viá»‡t, Nháº­t, bikini, Ã¡o dÃ i vÃ  hÆ¡n tháº¿ ná»¯a.`;
      const hashtags = keywords.toLowerCase().split(',').map(k => `#${k.trim().replace(/\s+/g, '')}`);
      return { title, description, hashtags };
    }

    function generatePostContent(imageLinks) {
      return imageLinks.map(link =>
        `<p><img src="${link}" alt="gÃ¡i xinh" style="width:100%;max-width:800px;margin:10px auto;display:block;"/></p>`
      ).join('\n');
    }

    function createBloggerPost(title, content, labels) {
      const blogId = '4779196080303412305';
      const body = JSON.stringify({ title, content, labels });

      gapi.client.request({
        path: `/blogger/v3/blogs/${blogId}/posts/`,
        method: 'POST',
        body: body
      }).then(function(response) {
        alert('âœ… BÃ i viáº¿t Ä‘Ã£ Ä‘Æ°á»£c Ä‘Äƒng lÃªn Blogger!');
        console.log(response);
      }, function(error) {
        alert('âŒ ÄÄƒng bÃ i tháº¥t báº¡i');
        console.error(error);
      });
    }

    document.getElementById('generatePost').onclick = () => {
      const kw = document.getElementById('keywords').value.trim();
      if (!kw || allLinks.length === 0) {
        alert('âš ï¸ Nháº­p tá»« khÃ³a vÃ  táº£i Ã­t nháº¥t má»™t áº£nh trÆ°á»›c!');
        return;
      }
      const seo = generateSeoContent(kw);
      const content = `<p>${seo.description}</p>` + generatePostContent(allLinks);
      createBloggerPost(seo.title, content, seo.hashtags);
    };

    function initClient() {
      gapi.client.init({
        apiKey: 'AIzaSyDUMMY_REPLACE_WITH_REAL_KEY', // Cáº§n thay báº±ng API Key náº¿u cÃ³
        clientId: '847908118054-dqsv7a47c8hajilv1e0k8e0gp5qdknlo.apps.googleusercontent.com',
        discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/blogger/v3/rest'],
        scope: 'https://www.googleapis.com/auth/blogger'
      }).then(() => gapi.auth2.getAuthInstance().signIn());
    }
    gapi.load('client:auth2', initClient);

    var feedback = function(res) {
      if (res.success === true) {
        const get_link = res.data.link.replace(/^http:\/\//i, 'https://');
        allLinks.push(get_link);
        document.querySelector('.status').classList.add('bg-success');
        document.querySelector('.status').innerHTML +=
          '<div class="linkimg"><input class="image-url" onclick="this.select()" value="' + get_link + '"/></div>' +
          '<div class="showimg"><img class="img" style="max-width:100%;margin-bottom:10px;" src="' + get_link + '"/></div>';
        updateCopyButton();
      }
    };

    new Imgur({
      clientid: '1460dad30d4be9a',
      callback: feedback
    });

    copyBtn.addEventListener('click', () => {
      const temp = document.createElement('textarea');
      temp.value = allLinks.join('\n');
      document.body.appendChild(temp);
      temp.select();
      document.execCommand('copy');
      document.body.removeChild(temp);
      alert("âœ… ÄÃ£ copy " + allLinks.length + " link áº£nh!");
    });
  </script>
</body>
</html>
